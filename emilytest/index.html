<!DOCTYPE html>
<html>
<head>
    <title>TaskFlow</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="custom_blocks.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div id="blocklyDiv" style="height: 480px; width: 600px;"></div>

    <!-- toolbox -->
    <xml id="toolbox" style="display: none;">
      <category name="Tasks">
        <block type="create_task"></block>
        <block type="assign_task"></block>
        <block type="set_dependency"></block>
        <block type="update_task_status"></block>
      </category>
      <category name="Filters">
        <block type="filter_tasks"></block>
        <block type="sort_tasks"></block>
      </category>
      <category name="Text">
        <block type="text"></block>
        <block type="custom_date"></block>
      </category>
    </xml>

    <div class="row button-row">
        <button onclick="generateCode()">Generate JavaScript</button>
        <button onclick="saveBlocks()">Save Blocks</button>
    </div>

    <div class="row">
        <div id="codeDiv" class="half-width"></div>
        <div id="outputDiv" class="half-width"></div>
    </div>

    <script>
        var workspace = Blockly.inject('blocklyDiv', {
          toolbox: document.getElementById('toolbox'),
          scrollbars: true
        });

        // Add event listener to the generate code button
  // const generateCodeButton = document.getElementById('generateCodeButton');
  // generateCodeButton.addEventListener('click', generateCode);

  // Function to generate code
  function generateCode() {
      var code = Blockly.JavaScript.workspaceToCode(workspace);
      document.getElementById('codeDiv').innerText = code;
  }

  function saveBlocks() {
      var xml = Blockly.Xml.workspaceToDom(workspace);
      var xmlText = Blockly.Xml.domToPrettyText(xml);
      var blob = new Blob([xmlText], {type: 'text/xml'});
      var a = document.createElement('a');
      a.download = 'blocks.xml';
      a.href = URL.createObjectURL(blob);
      a.click();
  }

  // // Function to create a task
  // function createTask(taskName, taskDescription, dueDate) {
  //   // Add your code here to create the task with the relevant information
  //   console.log(`Task created: ${taskName}`);
  //   console.log(`Task description: ${taskDescription}`);
  //   console.log(`Due date: ${dueDate}`);
  // }
  // function generateCode() {
  //     var code = Blockly.JavaScript.workspaceToCode(workspace);
  //     document.getElementById('codeDiv').innerText = code;
  // }

  // function runCode() {
  //     var code = Blockly.JavaScript.workspaceToCode(workspace);
  //     try {
  //         var output = eval(code);
  //         document.getElementById('outputDiv').innerText = output;
  //     } catch (e) {
  //         document.getElementById('outputDiv').innerText = 'Error: ' + e;
  //     }
  // }
  </script>
</body>
</html>
